# Lisa stack configuration
# Override per-project: .lisa/config.yaml | globally: ~/.config/lisa/config.yaml
# Only specify keys you want to change â€” deep merge keeps the rest

# Test commands: each command supports optional properties
# - paths: glob patterns for path filtering
# - filter: format template for test retries
# - preflight: (bool, default: true) run in preflight validation
#   Set to false to skip expensive commands before work starts
tests:
  - name: "Backend tests"
    run: "./gradlew test"
    paths: ["**/*.kt", "**/*.java"]
    filter: '--tests "*{test}"'
  - name: "Backend lint"
    run: "./gradlew ktlintFormat && ./gradlew ktlintCheck"
    paths: ["**/*.kt"]
  - name: "Backend static analysis"
    run: "./gradlew detekt"
    paths: ["**/*.kt"]
  - name: "Frontend tests"
    run: ".claude/scripts/run-frontend-tests.sh"
    paths: ["frontend/**/*.{ts,tsx,js,jsx}"]
  - name: "Frontend lint"
    run: "cd frontend && pnpm lint:check"
    paths: ["frontend/**/*.{ts,tsx,js,jsx}"]

format:
  - name: "Backend format"
    run: "./gradlew ktlintFormat"
    paths: ["**/*.kt"]
  - name: "Frontend format"
    run: "cd frontend && pnpm lint --fix"
    paths: ["frontend/**/*.{ts,tsx,js,jsx}"]

coverage:
  run: "./gradlew koverVerify"
  paths: ["**/*.kt", "**/*.java"]

fallback_tools: >-
  Read Edit Write Grep Glob Skill
  Bash(git:*) Bash(./gradlew:*) Bash(pnpm:*) Bash(npm:*)
  Bash(cd:*) Bash(ls:*) Bash(mkdir:*) Bash(rm:*)
